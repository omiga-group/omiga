const { File } = require("@asyncapi/generator-react-sdk");

export default async function ({ asyncapi, params }) {
  if (asyncapi.channels().length === 0) {
    return null;
  }

  const payloadContent = `
// Code generated by go-omiga-template, DO NOT EDIT.

package ${params.packageName}

import (
	_ "embed"
)

const TopicName = "${Object.keys(asyncapi.channels())[0]}"

//go:embed schema/jsonschema.json
var jsonschema string

//go:embed schema/dereferenced-jsonschema.json
var dereferencedJsonschema string

//go:embed schema/avro.avsc
var avro string

func GetJsonSchema() (string, error) {
  return jsonschema, nil
}

func GetDereferencedJsonSchema() (string, error) {
  return dereferencedJsonschema, nil
}

func GetAvroSchema() (string, error) {
  return avro, nil
}
`;

  return <File name="metadata_eventgen.go">{payloadContent}</File>;
}
